// COPYRIGHT Â© 2016 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/3.16/esri/copyright.txt for details.

define(["../kernel","../numberUtils","./RendererSlider/sliderUtils","dijit/_OnDijitClickMixin","dijit/_TemplatedMixin","dijit/_WidgetBase","dijit/form/NumberTextBox","dojo/debounce","dojo/on","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dnd/move","dojo/dom-construct","dojo/dom-style","dojo/dom-class","dojo/Evented","dojo/number","dojo/has","dojo/text!./RendererSlider/templates/RendererSlider.html"],function(e,t,i,a,s,o,n,l,r,h,d,u,m,c,b,_,p,L,f,v){var g=d([o,s,a,p],{declaredClass:"esri.dijit.RendererSlider",baseClass:"esriRendererSlider",templateString:v,theme:"Slider",intermediateChanges:!1,type:null,minimum:0,maximum:100,values:[50],precision:2,handles:[],primaryHandle:null,showHandles:!0,showTicks:!0,showLabels:!0,showRatioLabels:!1,minLabel:null,maxLabel:null,_visibleLabels:["data","handle"],_roundedDataLabels:[],_roundedHandleLabels:[],_ratioLabels:[],_minRatioLabel:"",_maxRatioLabel:"",_isZoomed:!1,_minZoomLabel:"",_maxZoomLabel:"",_maximumNumberEditor:null,_minimumNumberEditor:null,_valueDifferenceByIndex:[],_primaryHandleIdx:null,_currentTopValue:[],_isLTR:!0,_ctrlDown:!1,_histogramSurface:null,_css:null,_minPrecisionForSmallNumbers:3,constructor:function(e,t){this.inherited(arguments),this.domNode=t,this._css={container:"esri-renderer-slider",slidernode:"esri-slider-node",sliderarea:"esri-slider-area",sliderarearight:"esri-slider-area-right",moveable:"esri-moveable",handler:"esri-handle",handlerSpan:"esri-handle-span",handlerContainer:"esri-handle-container",handlerLabel:"esri-handle-label",handlerLabelSpan:"esri-handle-label-span",topLabelNode:"esri-top-label-node",bottomLabelNode:"esri-bottom-label-node",topLabelNodeHover:"esri-top-label-node-hover",bottomLabelNodeHover:"esri-bottom-label-node-hover",heatmapTick:"esri-heatmap-tick",handlerTick:"esri-handler-tick",handlerTickTop:"esri-handler-tick-top",handlerTickBottom:"esri-handler-tick-bottom"},this.showLabels=e.showLabels||this._visibleLabels,this._updateTimeout=l(this._updateTimeout,0)},startup:function(){if(this.inherited(arguments),this.set("_sliderHeight",b.get(this._sliderArea,"height")||200),this._checkMinMaxDefaults(),this.set("_isLTR",this.isLeftToRight()),!this._isLTR){var e=b.get(this._sliderNode,"padding-left")+b.get(this._sliderNode,"padding-right"),t=Math.round(b.get(this._sliderNode,"width"));this.set("_sliderNodeWidth_RTL",e+t)}this.set("precision",i.getCombinedPrecision(this.minimum,this.maximum)),this._updateRoundedLabels(),this._generateMoveables(),this._generateMinMaxEditors(),this._generateCtrlKeyListener(),this.watch("values",this._valuesChange),this.watch("minimum",this._updateTimeout),this.watch("maximum",this._updateTimeout),this.watch("showRatioLabels",this._updateTimeout)},destroy:function(){this.inherited(arguments)},setValue:function(e,t,i){var a=this.get("values"),s=a.slice(0);"object"==typeof a[0]?s[e].value=t:s[e]=t,(this.intermediateChanges||i)&&this.set("values",s),i?this.emit("stop",{values:this.get("values")}):this.emit("slide",{values:s})},_updateTimeout:function(){this._updateSlider()},_updateSlider:function(){this._reset(),this._checkMinMaxDefaults(),this._updateRoundedLabels(),this._generateMoveables(),this._generateMinMaxEditors(),this._generateCtrlKeyListener()},_checkMinMaxDefaults:function(){var e,t,i=this.values;this.minimum===this.maximum&&i&&i.length>0&&this.set(isNaN(i[0])?{minimum:0,maximum:2*i[0].value}:{minimum:0,maximum:2*i[0]}),i&&i.lenth>0&&(e=isNaN(i[0])?i[0].value:i[0],this.minimum>e&&this.set("minimum",e),t=isNaN(i[i.length-1])?i[i.length-1].value:i[i.length-1],this.maximum<t&&this.set("maximum",t))},_calculateValueFromHandlePosition:function(e){var t,i=this.get("minimum"),a=this.get("maximum"),s=this.get("precision"),o=this.get("step")||Math.pow(10,-s);return t=1>=i&&i>=-1&&1>=a&&a>=-1||s>=this._minPrecisionForSmallNumbers?(e*(a-i)+i)/o*o:parseFloat((Math.round((e*(a-i)+i)/o)*o).toFixed(s))},_generateMoveables:function(){var e,a=this._sliderNode,s=this._sliderHeight,o=this.get("minimum"),n=this.get("maximum"),l=this.get("precision"),r=(this.get("step")||Math.pow(10,-l),this.get("showLabels")),d=this.get("showTicks"),_=u.hitch(this,this.setValue),p=this.get("values");this._updateMinMaxLabels(),this.set("_primaryHandleIdx",null),e=h.map(p,u.hitch(this,function(l,p){var L,f,v,g,N,x;return l&&l.primaryHandle&&this.set("_primaryHandleIdx",p),"object"==typeof l&&l.hidden?null:("object"==typeof l&&(l=l.value),L=c.create("div",{style:this._getHandleStyleString(l),className:this._css.moveable},a),x=L._handleContainer=c.create("div",{className:this._css.handlerContainer},L),L._arrowSpan=g=c.create("span",{className:this._css.handlerSpan},x),L._handler=f=c.create("div",{className:this._css.handler},x),"HeatmapSlider"!==this.type&&(r===!0||"object"==typeof r&&-1!==h.indexOf(r,"handles"))&&(v=this._generateHandleLabel(L,p)),d&&this._generateHandleTicks(L,p),N=new m.constrainedMoveable(L,{handle:x,within:!0,constraints:u.hitch(this,function(){return{t:0,l:this._isLTR?0:this._sliderNodeWidth_RTL,w:0,h:s}})}),N.onMoveStart=u.hitch(this,function(t){var a,o,n,l,r,d,m,c,_=this.handles,f=h.indexOf(_,p);this._currentTopValue[p]=t.node.style.top,L.labelNode&&L.labelNode._autoPositioned&&(b.set(L.labelNode,"top","3px"),L.labelNode._autoPositioned=!1),i._autoPositionHandleLabels(this.get("moveables")),L._numberEditor&&(L._numberEditor.destroy(),L._numberEditor=null),this._primaryHandleIdx!==p?(_.length>0?(a=null!==_[f-1]?_[f-1]:null,o=null!==_[f+1]?_[f+1]:null,n=e[a],l=e[o]):(n=e[p-1],l=e[p+1]),n&&l?(r=n.style.top,d=l.style.top,m=Number(r.replace("px","")),c=Number(d.replace("px","")),N.constraints=u.hitch(this,function(){return{t:c+2,l:this._isLTR?0:this._sliderNodeWidth_RTL,w:0,h:s-c-(s-m+4)}})):n?(r=n.style.top,m=Number(r.replace("px","")),N.constraints=u.hitch(this,function(){return{t:0,l:this._isLTR?0:this._sliderNodeWidth_RTL,w:0,h:s-(s-m+2)}})):l&&(d=l.style.top,c=Number(d.replace("px","")),N.constraints=u.hitch(this,function(){return{t:c+2,l:this._isLTR?0:this._sliderNodeWidth_RTL,w:0,h:s-(c+2)}}))):(_.length>0?(a=null!==_[f-1]?_[f-1]:null,o=null!==_[f+1]?_[f+1]:null,n=e[a],l=e[o]):(n=e[p-1],l=e[p+1]),n&&l&&(r=n.style.top,d=l.style.top,m=Number(r.replace("px","")),c=Number(d.replace("px","")),N.constraints=u.hitch(this,function(){return{t:2,l:this._isLTR?0:this._sliderNodeWidth_RTL,w:0,h:s-4}})))}),N.onMoved=u.hitch(this,function(a){var l,r,d,m,c,L,f,g;if(p===this._primaryHandleIdx&&(d=Number(this._currentTopValue[p].replace("px",""))-Number(a.node.style.top.replace("px","")),this._currentTopValue[p]=a.node.style.top,h.forEach(e,u.hitch(this,function(e,i){if(e){if(i===p)return;if(m=Number(e.style.top.replace("px","")),L=m-d,l=1-Number(L/s),r=this._calculateValueFromHandlePosition(l),o>r||r>n)return;b.set(e,"top",L+"px"),_(i,r,!1),e.labelNode&&(e.labelNode.spanNode.innerHTML=this.showRatioLabels?this._getLabelValueFromIndex(i):t.format(r.toFixed(6)))}}))),l=1-Number(a.node.style.top.replace("px",""))/s,r=this._calculateValueFromHandlePosition(l),null!==this._primaryHandleIdx&&p!==this._primaryHandleIdx&&this._ctrlDown&&(d=Number(this._currentTopValue[p].replace("px",""))-Number(a.node.style.top.replace("px","")),this._currentTopValue[p]=a.node.style.top,0===p?(m=Number(e[e.length-1].style.top.replace("px","")),c=m+d,c>s&&(c=s),0>c&&(c=0),b.set(e[e.length-1],"top",c+"px"),g=1-c/s,f=this._calculateValueFromHandlePosition(g),_(e.length-1,f,!1),e[e.length-1].labelNode&&(e[e.length-1].labelNode.spanNode.innerHTML=t.format(f.toFixed(6)))):p===e.length-1&&(m=Number(e[0].style.top.replace("px","")),c=m+d,c>s&&(c=s),0>c&&(c=0),b.set(e[0],"top",c+"px"),g=1-c/s,f=this._calculateValueFromHandlePosition(g),_(0,f,!1),e[0].labelNode&&(e[0].labelNode.spanNode.innerHTML=t.format(f.toFixed(6))))),_(p,r,!1),this._updateRoundedLabels(),v){var N=t.format(parseFloat(t.round([r,parseFloat(this._getLabelValueFromIndex(p,!0))])[0]).toFixed(this.precision));v.spanNode.innerHTML=this.showRatioLabels?this._getLabelValueFromIndex(p):N}i._autoPositionHandleLabels(this.get("moveables"))}),N.onMoveStop=u.hitch(this,function(e){var a,o,n;if(n=Number(e.node.style.top.replace("px","")),a=1-n/s,o=this._calculateValueFromHandlePosition(a),_(p,o,!0),this._updateRoundedLabels(),v){var l=t.format(parseFloat(t.round([o,parseFloat(this._getLabelValueFromIndex(p,!0))])[0]).toFixed(this.precision));v.spanNode.innerHTML=this.showRatioLabels?this._getLabelValueFromIndex(p):l}i._autoPositionHandleLabels(this.get("moveables"))}),this.showHandles||(b.set(f,"display","none"),b.set(g,"display","none")),L)})),this.set("moveables",e),i._autoPositionHandleLabels(this.get("moveables"))},_reset:function(){h.forEach(this.moveables,u.hitch(this,function(e){e&&e.parentElement.removeChild(e)})),this.moveables=[]},_getHandleStyleString:function(e){var t=this.get("minimum"),i=this.get("maximum"),a=(e-t)/(i-t),s=Math.round((1-a)*this._sliderHeight),o=this._isLTR?0:this._sliderNodeWidth_RTL,n="left: "+o+"px;",l="top: "+s+"px;",r=l+" "+n;return r},_generateHandleTicks:function(e,t){var i=this._css,a=i.handlerTick+" "+i.handlerTickTop,s=i.handlerTick+" "+i.handlerTickBottom,o=0===t?s:a;"HeatmapSlider"===this.type&&(o+=i.heatmapTick),e._tick=c.create("div",{className:o},e)},_updateLabels:function(){this._updateMinMaxLabels(),this._updateRoundedLabels()},_resetLabelPositions:function(){h.forEach(this.moveables,function(e){if(e){var t=e.labelNode;t&&(b.set(t,"top","3px"),e.labelNode._autoPositioned=!1)}})},_generateHandleLabel:function(e,t){var i,a;return i=c.create("div",{className:this._css.handlerLabel},e),a=c.create("span",{className:this._css.handlerLabelSpan,innerHTML:this._getLabelValueFromIndex(t)},i),i.spanNode=a,e.labelNode=i,r(i,"click",u.hitch(this,function(){this._generateHandleLabelEditor(e,t)})),i},_updateMinMaxLabels:function(){var e,i,a,s,o,n,l=this.minimum,r=this.maximum,d=this.showLabels,u=this.minLabel,m=this.maxLabel,c=this._topNodeSpan,b=this._bottomNodeSpan,_=this._isZoomed,p=this._maxZoomLabel,L=this._minZoomLabel,f=this.showRatioLabels,v=this._maxRatioLabel,g=this._minRatioLabel,N=this._roundedDataLabels;d===!1||"object"==typeof d&&-1===h.indexOf(d,"data")?(c.innerHTML="",b.innerHTML=""):_?f?(c.innerHTML=v,b.innerHTML=g):(c.innerHTML=t.format(p),b.innerHTML=t.format(L)):f?(c.innerHTML=v,b.innerHTML=g):(e=isNaN(u)?u:t.round([u,m])[0],i=isNaN(m)?m:t.round([u,m])[1],a=isNaN(e)||null===e?u:t.format(e),s=isNaN(i)||null===i?m:t.format(i),o=t.format(N[0])||t.format(l),n=t.format(N[1])||t.format(r),c.innerHTML=s||n,b.innerHTML=a||o)},_updateRoundedLabels:function(){switch(this._roundedDataLabels=t.round([this.minimum,this.maximum]),this.type){case"SizeInfoSlider":case"ClassedSizeSlider":case"ClassedColorSlider":this._roundedHandleLabels=t.round(this.values);break;case"ColorInfoSlider":case"OpacitySlider":this._roundedHandleLabels=t.round(this._getValuesFromObject(this.values))}this._updateRatioLabels()},_updateRatioLabels:function(){var e,i,a=this.get("showRatioLabels"),s=this.get("minimum"),o=this.get("maximum"),n=this._getValuesFromObject(this.values),l=[];if(a!==!1){if("percent"!==a&&"percentTotal"!==a)return void this.set("showRatioLabels",!1);"percent"===a?(h.forEach(n,function(e){l.push(this._getRatioFromValue(e))},this),e=t.format(this._getRatioFromValue(s).toFixed(2)),i=t.format(this._getRatioFromValue(o).toFixed(2))):"percentTotal"===a&&(h.forEach(n,function(e){l.push(this._getRatioFromValue(e))},this),e=t.format(this._getRatioFromValue(s).toFixed(2)),i=t.format(this._getRatioFromValue(o).toFixed(2))),this.set({_ratioLabels:l,_minRatioLabel:e+"%",_maxRatioLabel:i+"%"})}},_generateMinMaxEditors:function(){!this.showLabels||"object"==typeof this.showLabels&&-1===h.indexOf(this.showLabels,"data")||"HeatmapSlider"===this.type?(_.remove(this._topNode,this._css.topLabelNodeHover),_.remove(this._botNode,this._css.bottomLabelNodeHover)):(r(this._topNode,"click",u.hitch(this,this._generateMaxEditor)),r(this._botNode,"click",u.hitch(this,this._generateMinEditor)))},_generateMaxEditor:function(){if(!(this._maximumNumberEditor&&this._topLabelNode||this._isZoomed)){var e,i,a=this.get("minLabel"),s=this.get("maxLabel"),o=this.get("maximum");this._topNodeSpan.innerHTML="",this._topLabelNode=c.create("input",{type:"text"},this._topNode),e=this.handles&&this.handles.length>0?this.values[this.handles[this.handles.length-1]]:this.values[this.values.length-1],"object"==typeof e&&(e=e.value),this.showRatioLabels&&(e=this._getLabelValueFromIndex(this.values.length-1,!0).replace("%",""),o=Number(this._maxRatioLabel.replace("%",""))),i=new n({value:Number(o),required:!0,constraints:{min:e,max:"percentTotal"===this.showRatioLabels?100:null,places:"0,20"}},this._topLabelNode),this._maximumNumberEditor=i,i.startup(),i.focus(),i.textbox.select();var l=!1;r(i,"keydown",u.hitch(this,function(e){if(l!==!1&&(i.validate=l),13===e.keyCode){var t=i.get("value");void 0===t&&(t=i.get("displayedValue")),t<=i.constraints.max&&t>=i.constraints.min?i.focusNode.blur():(l=i.validate,i.validate(!1),i.validate=function(){return!1})}})),r(i,"blur",u.hitch(this,function(){var e=isNaN(s)?s:t.round([a,s])[1],i=isNaN(e)||null===e?s:t.format(e),n=t.format(this._roundedDataLabels[1])||t.format(o);this._topNodeSpan.innerHTML=this.showLabels||"object"==typeof this.showLabels&&-1!==h.indexOf(this.showLabels,"data")?this.showRatioLabels?this._maxRatioLabel:i||n:"",this._maximumNumberEditor.destroy(),this._maximumNumberEditor=null})),r(i,"change",u.hitch(this,function(i){var n;if(i<Number(e)||isNaN(i)||void 0===i){var l=isNaN(s)?s:t.round([a,s])[1],r=isNaN(l)||null===l?s:t.format(l),h=t.format(this._roundedDataLabels[1])||t.format(o);return void(this._topNodeSpan.innerHTML=this.showRatioLabels?this._maxRatioLabel:r||h)}n=this.showRatioLabels?this._getValueFromPercent(i):i,this._topNodeSpan.innerHTML=this.showRatioLabels?n:t.format(i),this.set("maximum",n),this._reset(),this._updateRoundedLabels(),this._generateMoveables(),this._generateMinMaxEditors(),this.emit("data-value-change",{min:this.minimum,max:this.maximum,values:u.clone(this.values)})}))}},_generateMinEditor:function(){if(!(this._minimumNumberEditor&&this._botLabelNode||this._isZoomed)){var e,i,a=this.minLabel,s=this.maxLabel,o=this.minimum;this._bottomNodeSpan.innerHTML="",this._botLabelNode=c.create("input",{type:"text"},this._botNode),e=this.handles&&this.handles.length>0?this.values[this.handles[0]]:this.values[0],"object"==typeof e&&(e=e.value),this.showRatioLabels&&(e=this._getLabelValueFromIndex(0,!0).replace("%",""),o=Number(this._minRatioLabel.replace("%",""))),i=new n({value:Number(o),required:!0,constraints:{max:e,min:"percentTotal"===this.showRatioLabels?0:null,places:"0,20"}},this._botLabelNode),this._minimumNumberEditor=i,i.startup(),i.focus(),i.textbox.select();var l=!1;r(i,"keydown",u.hitch(this,function(e){if(l!==!1&&(i.validate=l),13===e.keyCode){var t=i.get("value");void 0===t&&(t=i.get("displayedValue")),t<=i.constraints.max&&t>=i.constraints.min?i.focusNode.blur():(l=i.validate,i.validate(!1),i.validate=function(){return!1})}})),r(i,"blur",u.hitch(this,function(){var e=isNaN(a)?a:t.round([a,s])[0],i=isNaN(e)||null===e?a:t.format(e),n=t.format(this._roundedDataLabels[0])||t.format(o);this._bottomNodeSpan.innerHTML=this.showLabels||"object"==typeof this.showLabels&&-1!==h.indexOf(this.showLabels,"data")?this.showRatioLabels?this._minRatioLabel:i||n:"",this._minimumNumberEditor.destroy(),this._minimumNumberEditor=null})),r(i,"change",u.hitch(this,function(i){var n;if(i>Number(e)||isNaN(i)||void 0===i){var l=isNaN(a)?a:t.round([a,s])[0],r=isNaN(l)||null===l?a:t.format(l),h=t.format(this._roundedDataLabels[0])||t.format(o);return void(this._bottomNodeSpan.innerHTML=this.showRatioLabels?this._minRatioLabel:r||h)}n=this.showRatioLabels?this._getValueFromPercent(i):i,this._bottomNodeSpan.innerHTML=this.showRatioLabels?n:t.format(i),this.set("minimum",n),this._reset(),this._updateRoundedLabels(),this._generateMoveables(),this._generateMinMaxEditors(),this.emit("data-value-change",{min:this.minimum,max:this.maximum})}))}},_generateHandleLabelEditor:function(e,t){if(!e._numberEditor){var i,a,s,o,l,d,m,b,_=this.get("handles"),p=this.get("maximum"),L=this.get("minimum"),f=this.get("_isZoomed"),v=this.get("values"),g=v[t],N=h.indexOf(_,t),x=e.labelNode,R=!1;"object"==typeof g&&(g=g.value),x.spanNode.innerHTML="",m=c.create("input",{type:"text"},x),_.length>0?(i=null!==_[N-1]?_[N-1]:null,a=null!==_[N+1]?_[N+1]:null,s=v[i],o=v[a],"object"==typeof s&&(s=s.value),"object"==typeof o&&(o=o.value)):(s=v[t-1],o=v[t+1],"object"==typeof s&&(s=s.value),"object"==typeof o&&(o=o.value)),l=void 0!==s&&null!==s?s:f&&!isNaN(this._minZoomLabel)?this._minZoomLabel:L,d=void 0!==o&&null!==o?o:f&&!isNaN(this._maxZoomLabel)?this._maxZoomLabel:p,this.showRatioLabels&&(g=this._getLabelValueFromIndex(t).replace("%",""),l=s?Number(this._getLabelValueFromIndex(i,!0).replace("%","")):Number(this._minRatioLabel.replace("%",""))||Number(this._getRatioFromValue(this.minimum)),d=o?Number(this._getLabelValueFromIndex(a,!0).replace("%","")):Number(this._maxRatioLabel.replace("%",""))||Number(this._getRatioFromValue(this.maximum))),b=new n({value:g,constraints:{min:l,max:d,places:"0,20"}},m),e._numberEditor=b,r(b,"keydown",u.hitch(this,function(e){if(R!==!1&&(b.validate=R),13===e.keyCode){var t=b.get("value");void 0===t&&(t=b.get("displayedValue")),t<=b.constraints.max&&t>=b.constraints.min?b.focusNode.blur():(R=b.validate,b.validate(!1),b.validate=function(){return!1})}})),r(b,"blur",u.hitch(this,function(){isNaN(b.get("value"))&&b.set("value",g),f&&(b.get("value")>p||b.get("value")<L)&&(this.set("_isZoomed",!1),this.emit("zoom-out")),x.spanNode.innerHTML=this._getLabelValueFromIndex(t),b.destroy(),e._numberEditor=null})),r(b,"change",u.hitch(this,function(e){var i=e;return e>b.constraints.max||e<b.constraints.min||isNaN(e)||void 0===e?void(x.spanNode.innerHTML=this._getLabelValueFromIndex(t)):(this.showRatioLabels&&(i=this._getValueFromPercent(e)),"object"==typeof this.values[t]?this.values[t].value=i:this.values[t]=i,this._reset(),this._updateRoundedLabels(),this._generateMoveables(),this._generateMinMaxEditors(),void this.emit("handle-value-change",{values:this.values}))})),b.focus(),b.textbox.select()}},_getRatioFromValue:function(e){var t,i=this.get("showRatioLabels");return t="percent"===i?100*e:"percentTotal"===i?e/(1+e)*100:null},_getValueFromPercent:function(e){var t,i=this.get("showRatioLabels");if("percent"===i)t=e/100;else if("percentTotal"===i){if(e>=100)return 100;t=e/(100-e)}return t},_getLabelValueFromIndex:function(e,i){var a;return a=this.showRatioLabels&&this._ratioLabels[e]?i===!0?parseFloat(this._ratioLabels[e].toFixed(2))+"%":t.format(parseFloat(this._ratioLabels[e].toFixed(2)))+"%":i===!0?this._roundedHandleLabels[e]:t.format(this._roundedHandleLabels[e])},_getValuesFromObject:function(e){var t=[];return h.forEach(e,function(e){t.push(e.value)}),t},_getDecimalPlaces:function(e){return L.format(e,{places:"0,20",round:-1}).replace(/^-?\d*\.?|0+$/g,"").length},_collisionCheck:function(e,t){return!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom)},_generateCtrlKeyListener:function(){r(document,"keydown",u.hitch(this,function(e){this._ctrlDown=e.metaKey||e.ctrlKey})),r(document,"keyup",u.hitch(this,function(e){this._ctrlDown=e.metaKey||e.ctrlKey}))},_valuesChange:function(){this.emit("change",{values:this.get("values")})}});return f("extend-esri")&&u.setObject("dijit.RendererSlider",g,e),g});